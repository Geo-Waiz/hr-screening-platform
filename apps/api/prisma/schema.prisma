  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Company {
  id        String   @id @default(cuid())
  name      String
  status    CompanyStatus @default(ACTIVE)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // Relations
  users     User[]
  candidates Candidate[]
  
  @@map("companies")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  firstName String
  lastName  String
  role      UserRole @default(USER)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // Relations
  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
  
  @@map("users")
}

model Candidate {
  id          String   @id @default(cuid())
  firstName   String
  lastName    String
  email       String
  phone       String?
  position    String
  status      CandidateStatus @default(PENDING)
  consentGiven Boolean @default(false)
  consentDate DateTime?
  notes       String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relations
  companyId   String
  company     Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
  screenings  Screening[]
  socialProfiles SocialProfile[]
  
  @@map("candidates")
}

model SocialProfile {
  id        String   @id @default(cuid())
  platform  SocialPlatform
  profileUrl String
  username  String?
  isActive  Boolean @default(true)
  lastScanned DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // Relations
  candidateId String
  candidate   Candidate @relation(fields: [candidateId], references: [id], onDelete: Cascade)
  
  @@unique([candidateId, platform])
  @@map("social_profiles")
}

model Screening {
  id          String   @id @default(cuid())
  status      ScreeningStatus @default(PENDING)
  riskLevel   RiskLevel?
  overallScore Int?
  summary     String?
  findings    Json?
  aiAnalysis  Json?
  humanReview String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  completedAt DateTime?
  reviewedAt  DateTime?
  
  // Relations
  candidateId String
  candidate   Candidate @relation(fields: [candidateId], references: [id], onDelete: Cascade)
  
  @@map("screenings")
}

// Enums
enum CompanyStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
}

enum UserRole {
  ADMIN
  MANAGER
  RECRUITER
  USER
}

enum CandidateStatus {
  PENDING
  SCREENING
  COMPLETED
  REJECTED
  HIRED
  ARCHIVED
}

enum ScreeningStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
  REQUIRES_REVIEW
}

enum RiskLevel {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum SocialPlatform {
  LINKEDIN
  TWITTER
  FACEBOOK
  INSTAGRAM
  TIKTOK
  YOUTUBE
  GITHUB
  OTHER
}
